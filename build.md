# Infimount – Build & Run Guide

This repo is a multi‑target Tauri + React app.  
Below are the steps to run and build the **desktop app** on Linux, Windows, macOS, and the entry points for iOS.

> All commands are from the repo root unless stated otherwise.

---

## 1. Prerequisites

- **Common**
  - Node.js ≥ 18
  - `pnpm` (or adapt commands to `npm`/`yarn`)
  - Rust toolchain (via `rustup`)
- **Tauri tooling**
  - Install the Tauri CLI in the desktop app:
    ```bash
    cd apps/desktop
    pnpm install
    pnpm tauri -h  # should print Tauri CLI help
    ```
- **Platform‑specific**
  - **Linux**
    - GTK3, WebKitGTK, and other system deps (see Tauri Linux prerequisites).
  - **Windows**
    - Visual Studio Build Tools and the Tauri Windows prerequisites.
  - **macOS**
    - Xcode + Command Line Tools.
  - **iOS**
    - Xcode with iOS SDK, simulator, and Tauri mobile tooling.

---

## 2. Development (desktop)

From the repo root:

```bash
cd apps/desktop
pnpm install
pnpm tauri dev
```

This will:
- Run the Vite dev server (React UI).
- Start the Tauri shell with hot‑reload.

---

## 3. Frontend production build

The Tauri bundler expects the built frontend at `apps/dist`.

From the repo root:

```bash
cd apps/desktop
pnpm build
```

This runs:
- `tsc` (type check)
- `vite build` with output configured to `../dist` (`apps/dist`).

---

## 4. Desktop app bundling with Tauri

After `pnpm build` succeeds:

```bash
cd apps/desktop
pnpm tauri build
```

### 4.1 Linux

On Linux this produces in `target/release`:

- Binary: `target/release/infimount`
- `.deb`: `target/release/bundle/deb/Infimount_0.1.0_amd64.deb`
- `.rpm`: `target/release/bundle/rpm/Infimount-0.1.0-1.x86_64.rpm`
- (Optional) AppImage: may require additional permissions; if it fails with “Permission denied”, rerun on your local machine with appropriate permissions.

Install the `.deb`:

```bash
sudo apt install ./target/release/bundle/deb/Infimount_0.1.0_amd64.deb
```

> **Icons on Linux:**  
> The `.deb` installs icons under:
> - `/usr/share/icons/hicolor/32x32/apps/Infimount.png`  
> - `/usr/share/icons/hicolor/128x128/apps/Infimount.png`  
> - `/usr/share/icons/hicolor/256x256@2/apps/Infimount.png`  
> and a desktop entry at `/usr/share/applications/Infimount.desktop` with `Icon=Infimount`.  
> If the dash still shows a generic gear, it is usually an icon cache issue:
> - Log out and log back in, **or**
> - Run a cache refresh for your desktop environment (e.g. `gtk-update-icon-cache` / `update-icon-caches`) after installing.

### 4.2 Windows

On a Windows machine:

```powershell
cd path\\to\\infimount\\apps\\desktop
pnpm install
pnpm build
pnpm tauri build
```

Tauri will generate a Windows executable and installer under `target\release\bundle\` (e.g. NSIS `.exe` or MSI, depending on configuration).

The app name and icon are taken from:
- `apps/desktop/src-tauri/tauri.conf.json` → `productName: "Infimount"`
- `apps/desktop/src-tauri/icons/icon.ico` (generated via `cargo tauri icon`).

### 4.3 macOS

On macOS:

```bash
cd /path/to/infimount/apps/desktop
pnpm install
pnpm build
pnpm tauri build
```

This will produce a `.app` bundle and (optionally) a `.dmg` under `target/release/bundle/`.

Icons are taken from:
- `apps/desktop/src-tauri/icons/icon.icns`
- and the sizes generated by `cargo tauri icon src-tauri/icons/MacOS.appiconset/icon-512x512.png`.

---

## 5. iOS (experimental)

The repo includes iOS icon assets under `apps/desktop/src-tauri/icons/ios` / `iOS Image` and `AppIcon.appiconset`, but iOS builds require:

- A macOS machine with Xcode and iOS tooling.
- Tauri mobile setup (`cargo tauri ios ...`).

Typical flow on macOS:

```bash
cd /path/to/infimount/apps/desktop
pnpm install
pnpm build
cargo tauri ios dev    # run in simulator
cargo tauri ios build  # create an iOS build
```

Additional provisioning/profile setup in Xcode is required to install on a physical device.

---

## 6. Icons overview

Desktop icons are configured in `apps/desktop/src-tauri/tauri.conf.json`:

```json
"bundle": {
  "icon": [
    "icons/32x32.png",
    "icons/128x128.png",
    "icons/128x128@2x.png",
    "icons/icon.icns",
    "icons/icon.ico"
  ]
}
```

These files are generated from your Mac icon source via:

```bash
cd apps/desktop
cargo tauri icon src-tauri/icons/MacOS.appiconset/icon-512x512.png
```

If you ever update the logo, re‑run the `cargo tauri icon` command and then rebuild with `pnpm tauri build`.
